// ==UserScript==
// @name         TikTok Without Watermarks
// @homepage     https://github.com/DumbCodeGenerator/TikTok-Without-Watermarks
// @version      0.7
// @description  Меняет видосы на сайте ТикТока на видосы без вотермарки
// @author       DumbCodeGenerator
// @run-at       document-end
// @match        *://*.tiktok.com/*
// @require      https://code.jquery.com/jquery-3.5.1.slim.min.js
// @grant        GM_xmlhttpRequest
// @connect      tiktokcdn.com
// ==/UserScript==
function removeA(e){let t,r,i=arguments,n=i.length;for(;n>1&&e.length;)for(t=i[--n];-1!==(r=e.indexOf(t));)e.splice(r,1);return e}!function(){"use strict";location.href;const e=[];new MutationObserver(function(t){const r=$("video.video-player.horizontal");if(0===r.length)return;let i=r.attr("src");i.includes("/aweme/v1/play")||e.includes(i)||(e.push(i),GM_xmlhttpRequest({method:"GET",url:i,headers:{Range:"bytes=12000-18000"},onload:function(t){const n=`https://api2-16-h2.musical.ly/aweme/v1/play/?video_id=${t.responseText.match(/vid:(.{32})/)[1]}&vr_type=0&is_play_url=1&source=PackSourceEnum_PUBLISH&media_type=4&ratio=default&improve_bitrate=1`;r.attr("src",n),r.get(0).play(),removeA(e,i)}}))}).observe($("#main").get(0),{childList:!0,subtree:!0})}();
